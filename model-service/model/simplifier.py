
'''def simplify_text(text:str):
    result = text+'tum tum tum sahur'
    return str(result)'''



'''from transformers import AutoTokenizer, AutoModelForSeq2SeqLM
import torch

MODEL_NAME = "disemenova/model_sum"  
DEVICE = "cuda" if torch.cuda.is_available() else "cpu"

tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME)
model = AutoModelForSeq2SeqLM.from_pretrained(MODEL_NAME)
model.to(DEVICE)
print(DEVICE)
model.eval()

def generate_summary(input_text: str) -> str:
    prompt = (
        f"Суммаризируй документ госуправления. Сохрани программы, таблицы, бюджеты: {input_text.strip()[:500]}"
    )

    inputs = tokenizer(
        prompt,
        return_tensors="pt",
        truncation=True,
        padding="max_length",
        max_length=512
    ).to(DEVICE)

    with torch.no_grad():
        output_ids = model.generate(
            input_ids=inputs["input_ids"],
            attention_mask=inputs["attention_mask"],
            max_length=200,
            num_beams=5,
            length_penalty=0.8,
            repetition_penalty=3.0,
            no_repeat_ngram_size=3,
            early_stopping=True
        )

    summary = tokenizer.decode(output_ids[0], skip_special_tokens=True)
    return summary

print(generate_summary('Протяженность автомобильных дорог  общего пользования  местного значения  муниципального образования «Верхнекетский район», утвержденная постановлениями Администрации Верхнекетского района, городского и сельских поселений « Об утверждении перечня автомобильных дорог  общего пользования  местного значения» составляет 634,9 км. (уменьшение произошло за счет уточнения протяженности при проведении паспортизации дорог). Основной целью развития сети автомобильных дорог муниципального района является обеспечение круглогодичного, стабильного сообщения автомобильным транспортом с областным центром и со всеми населенными пунктами. Наличие качественной автомобильной дороги круглогодичного действия и железнодорожного сообщения будет способствовать повышению инвестиционной привлекательности территории и комфортности проживания людей. Из-за  состояния дорог, не отвечающих нормативным требованиям, не могут быть открыты автобусные маршруты. Пассажирские перевозки между населенными пунктами осуществляются индивидуальными предпринимателями автомобилями вместимостью до 8 посадочных мест,  не требующих лицензии для перевозки пассажиров,  получив разрешение  на осуществление деятельности по перевозке пассажиров и багажа легковым транспортом. Приведение автомобильных дорог  общего пользования местного значения, не отвечающих нормативным требованиям,  в нормативное состояние в период 2017-2020 годы планируется за счет проведения работ по поддержанию в надлежащем техническом состоянии автомобильных дорог общего пользования местного значения и искусственных сооружений на них путем проведения мероприятий по обустройству дорог дорожными знаками, проведения текущих и капитальных ремонтов отдельных участков дорог и всей дорожной инфраструктуры в целом. Работы по ремонту и содержанию дорог общего пользования местного значения в границах населенных пунктов и вне границ населенных пунктов будут производиться в объёмах средств поступающих в дорожные фонды. В 2016 году на выполнение мероприятий по ремонту и содержанию дорог общего пользования местного значения в границах населенных пунктов и вне границ населенных пунктов направлено 42880,2 тыс. рублей, в т.ч. за счет средств областной субсидии 20234 тыс. руб. (отремонтировано 54 км автомобильных дорог, проведены капитальные ремонты мостов через р. Суйга и р. Николаевская). В 2017 году на выделенные средства областной субсидии в сумме 19,1 млн. рублей будет выполнен ремонт дорог в Белоярском городском поселении.'))
'''

'''from transformers import AutoTokenizer, AutoModelForSeq2SeqLM
import torch

MODEL_NAME = "disemenova/model_sum"  
DEVICE = "cuda" if torch.cuda.is_available() else "cpu"

tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME)
model = AutoModelForSeq2SeqLM.from_pretrained(MODEL_NAME)
model.to(DEVICE)
model.eval()

def generate_summary(input_text: str) -> str:
    prompt = (
        f"Суммаризируй документ госуправления. Сохрани программы, таблицы, бюджеты: {input_text.strip()[:500]}"
    )

    inputs = tokenizer(
        prompt,
        return_tensors="pt",
        truncation=True,
        padding="max_length",
        max_length=512
    ).to(DEVICE)

    with torch.no_grad():
        output_ids = model.generate(
            input_ids=inputs["input_ids"],
            attention_mask=inputs["attention_mask"],
            max_length=200,
            num_beams=5,
            length_penalty=0.8,
            repetition_penalty=3.0,
            no_repeat_ngram_size=3,
            early_stopping=True
        )

    summary = tokenizer.decode(output_ids[0], skip_special_tokens=True)
    return summary

# Пример текста
example_text = """
Протяженность автомобильных дорог  общего пользования  местного значения  муниципального образования «Верхнекетский район», утвержденная постановлениями Администрации Верхнекетского района, городского и сельских поселений « Об утверждении перечня автомобильных дорог  общего пользования  местного значения» составляет 634,9 км. (уменьшение произошло за счет уточнения протяженности при проведении паспортизации дорог).
Основной целью развития сети автомобильных дорог муниципального района является обеспечение круглогодичного, стабильного сообщения автомобильным транспортом с областным центром и со всеми населенными пунктами. Наличие качественной автомобильной дороги круглогодичного действия и железнодорожного сообщения будет способствовать повышению инвестиционной привлекательности территории и комфортности проживания людей.
Из-за  состояния дорог, не отвечающих нормативным требованиям, не могут быть открыты автобусные маршруты. Пассажирские перевозки между населенными пунктами осуществляются индивидуальными предпринимателями автомобилями вместимостью до 8 посадочных мест,  не требующих лицензии для перевозки пассажиров,  получив разрешение  на осуществление деятельности по перевозке пассажиров и багажа легковым транспортом.
Приведение автомобильных дорог  общего пользования местного значения, не отвечающих нормативным требованиям,  в нормативное состояние в период 2017-2020 годы планируется за счет проведения работ по поддержанию в надлежащем техническом состоянии автомобильных дорог общего пользования местного значения и искусственных сооружений на них путем проведения мероприятий по обустройству дорог дорожными знаками, проведения текущих и капитальных ремонтов отдельных участков дорог и всей дорожной инфраструктуры в целом. Работы по ремонту и содержанию дорог общего пользования местного значения в границах населенных пунктов и вне границ населенных пунктов будут производиться в объёмах средств поступающих в дорожные фонды.
В 2016 году на выполнение мероприятий по ремонту и содержанию дорог общего пользования местного значения в границах населенных пунктов и вне границ населенных пунктов направлено 42880,2 тыс. рублей, в т.ч. за счет средств областной субсидии 20234 тыс. руб. (отремонтировано 54 км автомобильных дорог, проведены капитальные ремонты мостов через р. Суйга и р. Николаевская). В 2017 году на выделенные средства областной субсидии в сумме 19,1 млн. рублей будет выполнен ремонт дорог в Белоярском городском поселении.
Улучшение технического состояния автомобильных дорог общего пользования  местного значения позволит решить вопросы по организации регулярного автобусного сообщения населенных пунктов с районным центром.
С целью систематизации мероприятий в области дорожного хозяйства в 2015 году утверждена муниципальная программа «Развитие транспортной системы Верхнекетского района на 2016-2021 годы».
 
"""
# Вызов функции
print(generate_summary(example_text))'''


from transformers import T5ForConditionalGeneration
import torch
from peft import PeftModel, PeftConfig

class CFG:
    MODEL_PATH = "disemenova/model_sum"
    MAX_SOURCE_LENGTH = 256
    MAX_TARGET_LENGTH = 128
    DEVICE = "cuda" if torch.cuda.is_available() else "cpu"

# Используем правильный класс модели и токенизатора для T5
base_model = T5ForConditionalGeneration.from_pretrained("IlyaGusev/rut5_base_sum_gazeta")
from transformers import AutoTokenizer
tokenizer = AutoTokenizer.from_pretrained("IlyaGusev/rut5_base_sum_gazeta")

# Загрузка адаптера и перенос на устройство
model = PeftModel.from_pretrained(base_model, CFG.MODEL_PATH)
model = model.merge_and_unload()
model.to(CFG.DEVICE)
model.eval()

def generate_summary(text: str) -> str:
    prompt = (
        "Суммаризируй документ госуправления. Сохрани программы, таблицы, бюджеты. "
        f"Текст: {text[:2000]}"
    )

    inputs = tokenizer(
        prompt,
        max_length=CFG.MAX_SOURCE_LENGTH,
        truncation=True,
        padding="max_length",
        return_tensors="pt"
    ).to(CFG.DEVICE)

    with torch.no_grad():
        summary_ids = model.generate(
            input_ids=inputs["input_ids"],
            attention_mask=inputs["attention_mask"],
            max_length=CFG.MAX_TARGET_LENGTH,
            num_beams=5,
            repetition_penalty=3.0,
            length_penalty=0.7,
            no_repeat_ngram_size=3,
            early_stopping=False
        )

    summary = tokenizer.decode(summary_ids[0], skip_special_tokens=True)
    summary = summary.replace("программа", "Программа").replace("приложение", "Приложение")
    return summary

# Пример вызова
example_text = """В 2017 году курсы повышения квалификации в соответствии с новыми требованиями ФГОС прошли все педагоги . 
У большинства педагогов не пройдена курсовая подготовка для работы с детьми с ограниченными возможностями здоровья . 
Важным фактором , определяющим качество кадрового корпуса системы дошкольного образования , является уровень заработной платы педагогов . 
В соответствии с Указом Президента Российской Федерации от 7 мая 2012 года № 597 « О мероприятиях по реализации государственной социальной политики » в 2013 году средняя заработная плата педагогических работников дошкольных образовательных организаций должна была достигнуть уровня средней заработной платы в сфере общего образования в регионе . 
За первое полугодие 2017 года данный показатель составляет 89,2 % . 
Все образовательные организации включились в систему независимой оценки качества образования . 
Одним из направлений модернизации общего образования является оценка его качества . 
В рамках региональной системы оценки качества общего образования проводится мониторинг качества предоставления образовательных услуг . 
Также в сфере дошкольного образования детей Парфеньевского муниципального района остаются актуальными следующие проблемы , требующие решения : устаревшая инфраструктура детских садов ; нехватка таких педагогических кадров и специалистов , как логопед , психолог , дефектолог ; предполагаемая нехватка кадров в ближайшие годы . 
Предусмотрены следующие приоритеты в образовательной политике на уровне дошкольного образования : 
- пополнение материально-технической базы детских садов ; 
- решение вопросов нехватки педагогических кадров и специалистов ( логопед , психолог , дефектолог ) ; 
- развитие сектора услуг по сопровождению раннего развития детей ( от 0 до 3 - х лет ) . 
Раздел III . 
Цели и задачи подпрограммы , целевые показатели реализации подпрограммы 
« Развитие дошкольного образования в Парфеньевском муниципальном районе » 
Цель подпрограммы : 
Обеспечение доступности и повышение качества дошкольного образования детей Парфеньевского муниципального района . 
Задачи программы : 
1. 
Обеспечение государственных гарантий реализации права на получение общедоступного и бесплатного дошкольного образования . 
2. 
Формирование системы независимой оценки качества работы организаций , оказывающих социальные услуги в сфере образования . 
3. 
Создание условий для организации обучения в образовательных организациях в соответствии с современными требованиями . 
4. 
Информационно - методическое обеспечение сектора услуг по сопровождению раннего развития детей от 0 до 3 - х лет . 
Целевые показатели реализации подпрограммы : 
Раздел IV . 
Перечень мероприятий подпрограммы 
« Развитие дошкольного образования в Парфеньевском муниципальном районе »"""  # можешь вставить тот же текст

#print(generate_summary(example_text))

